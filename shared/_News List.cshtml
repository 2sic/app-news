@inherits ToSic.Sxc.Dnn.RazorComponent
@using ToSic.Razor.Blade;

@RenderPage("_Assets.cshtml")

@{
  var parts = CreateInstance("_Parts.cshtml");
  var listParts = CreateInstance("_List Parts.cshtml");

  @* data we'll show *@
  var viewConfiguration = Content;
  var categoryInUrl = Request.QueryString["category"];
  var filteredCategory = AsList(Data["Category"]).FirstOrDefault();

  @* How it will be shown *@
  var multiColumns = (bool)PageData["UseColumns"];
  var showImages = (bool)PageData["ShowImages"];
  var showCatPicker = (bool)PageData["ShowCatPicker"];
}

@* Show Toolbar Menu if admin *@
@if(Edit.Enabled) {
  @listParts.AdminToolbarMenu(viewConfiguration)
  @parts.DetailsPageConfigWarning()
}

<div class="app-news app-news-list">
  @* Show title *@
  <h1 class="mb-3">
    @(filteredCategory != null
      ? filteredCategory.PageTitle
      : viewConfiguration.Title)
  </h1>

  @* Show category filter *@
  @if(showCatPicker) {
    @listParts.CategoryFilter(filteredCategory)
  }

  @* List the articles *@
  @if(multiColumns) {
    @listParts.ListArticlesMultiCol(AsList(Data["News"]), showImages, categoryInUrl)
  } else {
    @listParts.ListArticlesSingleCol(AsList(Data["News"]), categoryInUrl)
  }

  @* Show pagination if configured *@
  @if (viewConfiguration.ShowPagination) {
    var paging = CreateInstance("_List Paging.cshtml");
    var pages = AsList(Data["Paging"]).FirstOrDefault();
    @paging.Paging(pages, categoryInUrl)
  }
</div>