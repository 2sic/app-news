@inherits ToSic.Sxc.Dnn.RazorComponent
@using ToSic.Razor.Blade;
@using ToSic.Sxc.Search;
@using ToSic.Eav.Run;

@*
  Case #1: Bootstrap 3 - read the readme.md section "CSS Framework Detection"
*@
@if(Connect.Koi.Koi.Is("bs3")) {
  @RenderPage("bs3/_List.cshtml")
  return;
}
@*
  Case #2: Bootstrap 4 or Unknown CSS Framework
*@

@RenderPage("shared/_News List.cshtml", new {ShowImages = true, UseColumns = false, ShowCatPicker = true})

@functions{
  /// <summary>
  /// Populate the search - ensure that each entity has an own url/page
  /// </summary>
  public override void CustomizeSearch(Dictionary<string, List<ISearchItem>> searchInfos, IContainer moduleInfo, DateTime beginDate) {
    var parts = CreateInstance("shared/_Parts.cshtml");
    foreach (var si in searchInfos["SearchIndex"]) {
      var article = AsDynamic(si.Entity);
      si.QueryString = parts.DetailPageQueryString(article, "");
    }

    // Remove not needed streams
    var keys = searchInfos.Keys.ToList();
    foreach(var key in keys) {
      if (key != "SearchIndex") {
        searchInfos.Remove(key);
      }
    }
  }
}
